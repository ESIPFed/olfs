<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>Server4: THREDDS Catalogs</title>
<STYLE>
<!--
H1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#527CC1;font-size:22px;}
H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#527CC1;font-size:16px;}
H3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#527CC1;font-size:14px;}
BODY {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;}
B {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#527CC1;}
P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}
A {color : black;}
A.name {color : black;}
HR {color : #525D76;}
.rightBanner {
	left: 100px;
}
LI {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}
.style3 {font-size: 10px}
.style4 {font-size: 14px}
.style13 {font-family: "Courier New", Courier, mono}
-->
</STYLE>
</head>

<body>
<a href="http://www.opendap.org"><img src="images/logo.gif" alt="OPeNDAP Banner" width="206" height="93" border="0" /></a>
<h1 align="left">THREDDS Catalogs <br />
<span class="style4">Server4 <span class="style3">(version: beta-1.4)</span></span></h1>
<hr size="1" noshade="noshade" />
<p align="center">&nbsp;</p>
<p>This release of Server4 supports the complete THREDDS catalog service stack. THREDDS catalogs are controlled by a <em>catalog.xml</em> file located in the (persistent) content directory for the OLFS (More on that here). Rather than provide an exhaustive explanation of the THREDDS catalog functionality and configuration I will appeal to the existing documents provided by our fine colleagues at <a href="http://www.unidata.ucar.edu/projects/THREDDS/">UNIDATA</a>: </p>
<ul>
  <li><a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/index.html#catalog">Catalog Basics</a></li>
  <li><a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/catalog/InvCatalogSpec.html">Catalog Specification </a></li>
  <li><a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/catalog/Primer.html">Catalog Primer</a></li>
  <li><a href="http://www.unidata.ucar.edu/projects/THREDDS/tech/cataloggen/devel/datasetScanElement.html">DatasetScan Element</a> </li>
</ul>
<p>The additional important piece of configuration information is regarding the implementation of CrawlableDataset to be used with Server4, <em>opendap.olfs.BESCrawlableDataset</em>. This class must be specified in any<em> datsetScan</em> element used with server 4. </p>
<p>Here is an example <em>catalog.xml</em> file:</p>
<pre class="style13">
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;catalog name=&quot;Server4 Test Catalog&quot;
         xmlns=&quot;http://www.unidata.ucar.edu/namespaces/thredds/InvCatalog/v1.0&quot;
         xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;

     &lt;!-- ************************************************************************************* --&gt;

     &lt;service name=&quot;OPeNDAP-Server4&quot; serviceType=&quot;OPeNDAP&quot; base=&quot;/opendap/ts/&quot;/&gt;

     &lt;datasetScan location=&quot;/root/nc&quot; path=&quot;nc&quot; name=&quot;NC&quot; serviceName=&quot;OPeNDAP-Server4&quot;&gt;

	       &lt;crawlableDatasetImpl className=&quot;opendap.olfs.BESCrawlableDataset&quot; /&gt;

           &lt;filter&gt;
               &lt;exclude wildcard=&quot;.*&quot; atomic=&quot;true&quot; collection=&quot;true&quot; /&gt;
               &lt;include wildcard=&quot;*.nc&quot; /&gt;
           &lt;/filter&gt;
           &lt;addDatasetSize /&gt;

           &lt;metadata inherited=&quot;true&quot;&gt;
               &lt;serviceName&gt;OPeNDAP-Server4&lt;/serviceName&gt;
               &lt;authority&gt;opendap.org&lt;/authority&gt;
               &lt;dataType&gt;Random&lt;/dataType&gt;
           &lt;/metadata&gt;
     &lt;/datasetScan&gt;

     &lt;!-- ************************************************************************************* --&gt;
&lt;/catalog&gt;
</pre>
<p>&nbsp;</p>
<p>In particular note the following:</p>
<ul>
  <li>The line in which the CrawlableDataset implementation is defined:

    <pre>&lt;crawlableDatasetImpl className=&quot;opendap.olfs.BESCrawlableDataset&quot; /&gt; </pre>
    Identifies the correct CrawlableDataset class for Server4 - the one that works with the <em>BES</em> to automatically generate catalogs. <br />
    <br />
    <br />
  </li>
  <li>In the <em>&lt;datasetScan&gt;</em> element the <em>location</em> attribute's value MUST begin with <em>/root</em>. So, if the top level collection in the BES contains 4 sub collections they may each be identified using a separate  <em>&lt;datasetScan&gt;</em> element like so:
    <pre>
	&lt;datasetScan location=&quot;/root/nc&quot;  path=&quot;nc&quot;  name=&quot;NetCDF Archive&quot;   serviceName=&quot;OPeNDAP-Server4&quot;&gt; . . . &lt;/datasetScan&gt;
	&lt;datasetScan location=&quot;/root/hdf&quot; path=&quot;hdf&quot; name=&quot;HDF Archive&quot;      serviceName=&quot;OPeNDAP-Server4&quot;&gt; . . . &lt;/datasetScan&gt;
	&lt;datasetScan location=&quot;/root/jg&quot;  path=&quot;jg&quot;  name=&quot;JGOFFS Archive&quot;   serviceName=&quot;OPeNDAP-Server4&quot;&gt; . . . &lt;/datasetScan&gt;
	&lt;datasetScan location=&quot;/root/ff&quot;  path=&quot;ff&quot;  name=&quot;FreeForm Archive&quot; serviceName=&quot;OPeNDAP-Server4&quot;&gt; . . . &lt;/datasetScan&gt;</pre>
	Where each <em>&lt;datasetScan&gt;</em> element may have it's own filter and inheritance rules. You MUST NOT lump them all into one    <em>&lt;datasetScan&gt;</em>element with one set of filter rules like so:
	<pre>
	&lt;datasetScan location=&quot;/root&quot;     path=&quot;DATA&quot;  name=&quot;AllYourDataAreUs&quot;   serviceName=&quot;OPeNDAP-Server4&quot;&gt; . . . &lt;/datasetScan&gt;</pre>
	Because it does not work.
    <br />
    <br />
  </li>
  <li>The <em>path</em> attribute in the <em>&lt;datasetScan&gt;</em> element appears in the URL after the servlet name, and MUST be the same as the value of the<em> location</em> attribute with the leading &quot;/root/&quot; removed. In other words it MUST NOT start with a &quot;/&quot; character . </li>
</ul>
<p>&nbsp;</p>
<hr size="1" noshade="noshade" />
<h3><br /></h3>
</body>
</html>
