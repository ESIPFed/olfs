<?xml version="1.0"?>

<!DOCTYPE project [
    <!ENTITY globalprops      SYSTEM "file:./globalprops.xml">
    <!ENTITY globaltargets    SYSTEM "file:./globaltargets.xml">
]>

<!-- Build file for OPeNDAP core software -->


<project name="Server4 Test Client" default="all" basedir="..">

    <!-- Compiler Settings -->

    <property name="compile.debug" value="on"/>
    <property name="compile.debuglevel" value="lines,vars,source"/>
    <property name="compile.deprecation" value="on"/>

    <property name="modern.compiler" value="modern"/>
    <property name="classic.compiler" value="classic"/>

    <!--  build.compiler: This is a "magic" property.
         In the javac task, if the "compiler" property is not
         explicitly set, then javac will use the value of this
         property ("build.compiler") to set the compiler type.

    See the online ANT Users Manual.
    Read the section the comipler attribute of the javac task.
    http://ant.apache.org/manual/index.html
    -->
    <property name="build.compiler" value="${modern.compiler}"/>

    <!-- Global Properties -->
    <property name="build.sysclasspath" value="ignore"/>



    <!-- Project directories -->
    <property name="src.dir"        location="src"/>
    <property name="doc.dir"        location="doc"/>
    <property name="lib.dir"        location="lib"/>
    <property name="axislib.dir"    location="AxisLib"/>
    <property name="bin.dir"        location="bin"/>
    <property name="dist.dir"       location="dist"/>
    <property name="datasets.dir"   location="datasets"/>
    <property name="schema.dir"     location="schema"/>
    <property name="buildfiles.dir" location="buildfiles"/>

    <property name="build.dir"      location="build"/>
    <property name="build.classes"  location="${build.dir}/classes"/>
    <property name="build.doc"      location="${build.dir}/doc"/>
    <property name="build.dist"     location="${build.dir}/dist"/>
    <property name="build.lib"      location="${build.dir}/lib"/>


    <!-- Libraries -->
    <property name="jdom.lib"                     value="jdom-1.0.jar"/>
    <property name="opendap.lib"                  value="opendap-0.0.2.jar"/>
    <property name="cli.lib"                      value="apache-commons-cli-1.0.jar"/>

    <property name="axis.lib"                     value="axis-1.3.0.jar"/>
    <property name="apache-commons-discovery.lib" value="commons-discovery-0.2.jar"/>
    <property name="apache-commons-logging.lib"   value="commons-logging-1.0.4.jar"/>
    <property name="activation.lib"               value="jaf-1.0.2.jar"/>
    <property name="javamail.lib"                 value="java-mail-1.3.3_01.jar"/>
    <property name="jaxrpc.lib"                   value="jaxrpc.jar"/>
    <property name="soap-attachments.lib"         value="saaj.jar"/>


    <!-- Global Targets -->
    &globaltargets;

    <!-- Library (class)paths -->
    <path id="compile.classpath">
        <pathelement path="${build.classes}"/>
        <fileset dir="${lib.dir}">
            <include name="${opendap.lib}"/>
            <include name="${jdom.lib}"/>
            <include name="${cli.lib}"/>
        </fileset>
        <fileset dir="${axislib.dir}">
            <include name="${axis.lib}"/>
            <include name="${apache-commons-discovery.lib}"/>
            <include name="${apache-commons-logging.lib}"/>
            <include name="${activation.lib}"/>
            <include name="${javamail.lib}"/>
            <include name="${jaxrpc.lib}"/>
            <include name="${soap-attachments.lib}"/>
        </fileset>
    </path>





    <target name="all" depends="clean,compile,dist" description="Builds stuff"/>


    <target name="compile"
        depends="init"
        description="Compiles Server4 Test Client Application."
        >
        <echo level="info" message="AntFile: ${ant.file} Compiling Test Client"/>
        <echo level="info" message="Using the ${build.compiler} javac compiler"/>
        <echo level="info" message=""/>
        <javac compiler="${build.compiler}"
            destdir="${build.classes}"
            debug="${compile.debug}"
            debuglevel="${compile.debuglevel}"
            deprecation="${compile.deprecation}">

            <classpath refid="compile.classpath"/>

            <src path="${src.dir}"/>
            <include name="opendap/soap/*.java"/>
        </javac>

    </target>



    <target name="dist"
        depends="clean,compile"
        description="Builds executable jar files">

        <mkdir dir="${build.dist}/TestClient"/>

        <jar destfile="${build.dist}/TestClient/tc.jar"
            manifest="jar/TestClient.MANIFEST.MF">
            <fileset dir="${build.classes}"/>
        </jar>

        <copy todir="${build.dist}/TestClient">
            <fileset dir="${lib.dir}">
                <include name="${opendap.lib}"/>
                <include name="${jdom.lib}"/>
                <include name="${cli.lib}"/>
            </fileset>
            <fileset dir="${axislib.dir}">
                <include name="${axis.lib}"/>
                <include name="${apache-commons-discovery.lib}"/>
                <include name="${apache-commons-logging.lib}"/>
                <include name="${activation.lib}"/>
                <include name="${javamail.lib}"/>
                <include name="${jaxrpc.lib}"/>
                <include name="${soap-attachments.lib}"/>
            </fileset>
        </copy>

        <jar destfile="${build.dist}/TestClient.jar">
            <fileset dir="${build.dist}/TestClient"/>
        </jar>



    </target>





</project>










